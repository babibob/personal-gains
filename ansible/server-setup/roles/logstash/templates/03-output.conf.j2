output {
 if "marketplace" in [kubernetes][namespace] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "marketplace-%{+YYYY.MM.dd}"
   }
 } else if "rabbitmq" in [kubernetes][namespace] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "production-%{+YYYY.MM.dd}"
   }
 } else if "kafka" in [kubernetes][namespace] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "production-%{+YYYY.MM.dd}"
   }
 } else if "jaeger" in [kubernetes][namespace] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "production-%{+YYYY.MM.dd}"
   }
 } else if "mongodb-crawler" in [kubernetes][namespace] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "production-%{+YYYY.MM.dd}"
   }
 } else if "ingress-nginx" in [kubernetes][namespace] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "production-%{+YYYY.MM.dd}"
   }
 } else if "yandex_agent_prod" in [tags] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "agents_prod_kube-%{+YYYY.MM.dd}"
   }
 } else if "docker_servers" in [tags] {
   elasticsearch {
       hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
       index => "docker-servers-%{+YYYY.MM.dd}"
   }
 } else if "sib_ru" in [tags] {
   elasticsearch {
       hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
       index => "sib-ru-%{+YYYY.MM.dd}"
   }
 } else if "nginx-access" in [tags] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "nginx-access-%{+YYYY.MM.dd}"
   }
 } else if [type] == "nginx_access" {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "nginx-access-%{+YYYY.MM.dd}"
   }
 } else if "storage" in [tags] {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "storage-%{+YYYY.MM.dd}"
   }
 }
else {
   elasticsearch {
     hosts => [ {% for hosts in groups['elks'] -%}'{{ hostvars[hosts].ansible_ssh_host }}:9200'{% if not loop.last %},{% endif %}{%- endfor %} ]
     index => "logstash-%{+YYYY.MM.dd}"
   }
 } 
}

